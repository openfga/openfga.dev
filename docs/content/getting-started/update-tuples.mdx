---
title: Update Relationship Tuples
sidebar_position: 3
slug: /getting-started/update-tuples
description: Introduction to adding and deleting relationship tuples
---

import {
  DocumentationNotice,
  RelatedSection,
  SdkSetupHeader,
  SupportedLanguage,
  languageLabelMap,
  ProductConcept,
  ProductName,
  ProductNameFormat,
  WriteRequestViewer,
  SdkSetupPrerequisite,
} from '@components/Docs';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Update Relationship Tuples

<DocumentationNotice />

This is an introduction to adding and deleting _<ProductConcept section="what-is-a-relationship-tuple" linkName="relationship tuples" />_.

## Before you start

<Tabs groupId="languages">
<TabItem value={SupportedLanguage.JS_SDK} label={languageLabelMap.get(SupportedLanguage.JS_SDK)}>

1. <SdkSetupPrerequisite />
2. You have [installed the SDK](./install-sdk.mdx).
3. You have [configured the _authorization model_](./configure-model.mdx).
4. You have loaded `FGA_STORE_ID` and `FGA_API_URL` as environment variables.

</TabItem>
<TabItem value={SupportedLanguage.GO_SDK} label={languageLabelMap.get(SupportedLanguage.GO_SDK)}>

1. <SdkSetupPrerequisite />
2. You have [installed the SDK](./install-sdk.mdx).
3. You have [configured the _authorization model_](./configure-model.mdx).
4. You have loaded `FGA_STORE_ID` and `FGA_API_URL` as environment variables.

</TabItem>
<TabItem value={SupportedLanguage.DOTNET_SDK} label={languageLabelMap.get(SupportedLanguage.DOTNET_SDK)}>

1. <SdkSetupPrerequisite />
2. You have [installed the SDK](./install-sdk.mdx).
3. You have [configured the _authorization model_](./configure-model.mdx).
4. You have loaded `FGA_STORE_ID` and `FGA_API_URL` as environment variables.

</TabItem>
<TabItem value={SupportedLanguage.PYTHON_SDK} label={languageLabelMap.get(SupportedLanguage.PYTHON_SDK)}>

1. <SdkSetupPrerequisite />
2. You have [installed the SDK](./install-sdk.mdx).
3. You have [configured the _authorization model_](./configure-model.mdx).
4. You have loaded `FGA_STORE_ID` and `FGA_API_URL` as environment variables.

</TabItem>
<TabItem value={SupportedLanguage.JAVA_SDK} label={languageLabelMap.get(SupportedLanguage.JAVA_SDK)}>

1. <SdkSetupPrerequisite />
2. You have [installed the SDK](./install-sdk.mdx).
3. You have [configured the _authorization model_](./configure-model.mdx).
4. You have loaded `FGA_STORE_ID` and `FGA_API_URL` as environment variables.

</TabItem>
<TabItem value={SupportedLanguage.CLI} label={languageLabelMap.get(SupportedLanguage.CLI)}>

1. <SdkSetupPrerequisite />
2. You have [configured the _authorization model_](./configure-model.mdx).
3. You have loaded `FGA_STORE_ID` and `FGA_API_URL` as environment variables.

</TabItem>
<TabItem value={SupportedLanguage.CURL} label={languageLabelMap.get(SupportedLanguage.CURL)}>

1. <SdkSetupPrerequisite />
2. You have [configured the _authorization model_](./configure-model.mdx).
3. You have loaded `FGA_STORE_ID` and `FGA_API_URL` as environment variables.

</TabItem>
</Tabs>

## Step by step

Assume that you want to add user `user:anne` to have relationship `reader` with object `document:Z`

```json
{
  user: 'user:anne',
  relation: 'reader',
  object: 'document:Z'
}
```

### 01. Configure the <ProductName format={ProductNameFormat.ShortForm}/> API client

Before calling the write API, you will need to configure the API client.

<Tabs groupId="languages">
<TabItem value={SupportedLanguage.JS_SDK} label={languageLabelMap.get(SupportedLanguage.JS_SDK)}>

<SdkSetupHeader lang={SupportedLanguage.JS_SDK} />

</TabItem>
<TabItem value={SupportedLanguage.GO_SDK} label={languageLabelMap.get(SupportedLanguage.GO_SDK)}>

<SdkSetupHeader lang={SupportedLanguage.GO_SDK} />

</TabItem>
<TabItem value={SupportedLanguage.DOTNET_SDK} label={languageLabelMap.get(SupportedLanguage.DOTNET_SDK)}>

<SdkSetupHeader lang={SupportedLanguage.DOTNET_SDK} />

</TabItem>
<TabItem value={SupportedLanguage.PYTHON_SDK} label={languageLabelMap.get(SupportedLanguage.PYTHON_SDK)}>

<SdkSetupHeader lang={SupportedLanguage.PYTHON_SDK} />

</TabItem>
<TabItem value={SupportedLanguage.JAVA_SDK} label={languageLabelMap.get(SupportedLanguage.JAVA_SDK)}>

<SdkSetupHeader lang={SupportedLanguage.JAVA_SDK} />

</TabItem>
<TabItem value={SupportedLanguage.CLI} label={languageLabelMap.get(SupportedLanguage.CLI)}>

<SdkSetupHeader lang={SupportedLanguage.CLI} />

</TabItem>
<TabItem value={SupportedLanguage.CURL} label={languageLabelMap.get(SupportedLanguage.CURL)}>

To obtain the [access token](https://auth0.com/docs/get-started/authentication-and-authorization-flow/client-credentials-flow/call-your-api-using-the-client-credentials-flow):

<SdkSetupHeader lang={SupportedLanguage.CURL} />

</TabItem>
</Tabs>

### 02. Calling write API to add new relationship tuples

To add the relationship tuples, we can invoke the write API.

<WriteRequestViewer
  relationshipTuples={[
    {
      user: 'user:anne',
      relation: 'reader',
      object: 'document:Z'
    },
  ]}
  skipSetup={true}
  allowedLanguages={[
    SupportedLanguage.JS_SDK,
    SupportedLanguage.GO_SDK,
    SupportedLanguage.DOTNET_SDK,
    SupportedLanguage.PYTHON_SDK,
    SupportedLanguage.JAVA_SDK,
    SupportedLanguage.CLI,
    SupportedLanguage.CURL,
  ]}
/>

### 03. Calling write API to delete relationship tuples

To delete relationship tuples, we can invoke the write API.

Assume that you want to delete user `user:anne`'s `reader` relationship with object `document:Z`

```json
{
  user: 'user:anne',
  relation: 'reader',
  object: 'document:Z'
}
```

<WriteRequestViewer
  deleteRelationshipTuples={[
    {
      user: 'user:anne',
      relation: 'reader',
      object: 'document:Z'
    },
  ]}
  skipSetup={true}
  allowedLanguages={[
    SupportedLanguage.JS_SDK,
    SupportedLanguage.GO_SDK,
    SupportedLanguage.DOTNET_SDK,
    SupportedLanguage.PYTHON_SDK,
    SupportedLanguage.JAVA_SDK,
    SupportedLanguage.CLI,
    SupportedLanguage.CURL,
  ]}
/>

### 04. Writing and deleting relationship tuples in the same request

You can combine both writes and deletes in a single transactional API request. This is useful when you need to update multiple relationships atomically. All operations in the request will either succeed together or fail together.

The Write API allows you to send up to `100` unique tuples in the request. (This limit applies to the sum of both writes and deletes in that request).

For example, you might want to remove `user:anne` as a `writer` of `document:Z` while simultaneously updating `user:anne` as an `reader` of `document:Z`:

<WriteRequestViewer
  relationshipTuples={[
    {
      user: 'user:anne',
      relation: 'reader',
      object: 'document:Z'
    },
  ]}
  deleteRelationshipTuples={[
    {
      user: 'user:anne',
      relation: 'writer',
      object: 'document:Z'
    },
  ]}
  skipSetup={true}
  allowedLanguages={[
    SupportedLanguage.JS_SDK,
    SupportedLanguage.GO_SDK,
    SupportedLanguage.DOTNET_SDK,
    SupportedLanguage.PYTHON_SDK,
    SupportedLanguage.JAVA_SDK,
    SupportedLanguage.CLI,
    SupportedLanguage.CURL,
  ]}
/>

This approach ensures that both operations succeed or fail together, maintaining transactional data consistency.


:::note
When using the Write API, you cannot include the same tuple (same user, relation, and object) in the writes or deletes arrays within a single request. The API will return an error with code `cannot_allow_duplicate_tuples_in_one_request` if detected.
:::

### 05. Ignoring duplicate or missing tuples

Sometimes you might need to write a tuple that already exists, which would normally cause the whole request to fail. You can use the `on_duplicate: "ignore"` parameter to handle this gracefully. 

This is particularly useful for high-volume data imports, migrations, or ensuring certain permissions exist without complex error handling logic.

For example, if you want to ensure `user:anne` has `reader` access to `document:Z` without worrying about whether the relationship already exists in <ProductName format={ProductNameFormat.ShortForm}/>:

<WriteRequestViewer
  relationshipTuples={[
    {
      user: 'user:anne',
      relation: 'reader',
      object: 'document:Z'
    },
  ]}
  writeOptions={{
    on_duplicate: 'ignore',
  }}
  skipSetup={true}
  allowedLanguages={[
    SupportedLanguage.CURL,
  ]}
/>

:::caution
At the moment, this feature is only available on the API (v1.10.0). Supported SDKs will follow shortly after.
:::

Similarly, you can use `on_missing: "ignore"` when deleting tuples that might not exist.

<WriteRequestViewer
  skipSetup={true}
  deleteRelationshipTuples={[
    {
      user: 'user:anne',
      relation: 'writer',
      object: 'document:Z'
    },
  ]}
  deleteOptions={{
    on_missing: 'ignore',
  }}
  expectedResponse={{
    data: {},
  }}
  allowedLanguages={[
    SupportedLanguage.CURL,
  ]}
/>

The behavior of `on_duplicate: "ignore"` is more nuanced for tuples with conditions.
- **Identical Tuples**: If a tuple in the request is identical to an existing tuple (same user, relation, object, condition name, and condition context), it will be safely ignored.
- **Conflicting Tuples**: If a tuple key (user, relation, object) matches an existing tuple, but the condition name or parameters are different, this is a conflict. The write attempt will be rejected, and the entire transaction will fail with a `409 Conflict` error.

## Related Sections

<RelatedSection
  description="Check the following sections for more on how to write your authorization data"
  relatedLinks={[
     {
      title: 'Write API',
      description: 'Learn more about the Write API options.',
      link: '/api/service#Relationship%20Tuples/Write',
    },
    {
      title: 'Managing User Access',
      description: 'Learn about how to give a user access to a particular object.',
      link: '../interacting/managing-user-access',
      id: '../interacting/managing-user-access.mdx',
    },
    {
      title: 'Managing Group Access',
      description: 'Learn about how to give a group of users access to a particular object.',
      link: '../interacting/managing-group-access',
      id: '../interacting/managing-group-access.mdx',
    },
  ]}
/>