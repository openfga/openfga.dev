<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://openfga.dev/blog</id>
    <title>OpenFGA Blog</title>
    <updated>2023-11-06T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://openfga.dev/blog"/>
    <subtitle>OpenFGA Blog</subtitle>
    <icon>https://openfga.dev/img/openfga-icon.svg</icon>
    <entry>
        <title type="html"><![CDATA[Conditional Relationship Tuples for OpenFGA]]></title>
        <id>https://openfga.dev/blog/conditional-tuples-announcement</id>
        <link href="https://openfga.dev/blog/conditional-tuples-announcement"/>
        <updated>2023-11-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Conditional Relationship Tuples for OpenFGA]]></summary>
        <content type="html"><![CDATA[<p>Relationship Tuples are the facts that the OpenFGA evaluates to determine whether a user is permitted to access a resource.</p><p>The way tuples are considered when making authorization decisions in OpenFGA is guided by an authorization model, which employs concepts from Relationship-Based Access Control (ReBAC) to establish authorization policies. For instance, you might declare that users are allowed to view a document if they have permission to view its parent folder.</p><p>Although ReBAC offers a highly flexible method for structuring permissions, it encounters difficulties with defining permissions based on attributes that are not easily represented as relationships. Attributes such as “parent folder,” “department,” “region,” and “country” can be conceptualized as relationships between two entities. However, attributes like “IP address,” “time of day,” “team size limit,” or “maximum amount for a bank transfer” cannot be easily handled.</p><p>In our ongoing efforts to expand OpenFGA’s capacity for articulating a broader range of authorization policies, we are introducing <strong>Conditional Relationship Tuples</strong>. These allow for the specification of conditions under which a particular tuple is relevant when evaluating an authorization query.</p><p>Consider the following example, where we utilize Conditional Tuples to grant access for a user over a specified time duration. We stipulate that a user may be granted either unconditional access or access constrained to a certain time period:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">model</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  schema </span><span class="token number">1.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> document</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  relations</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    define viewer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> user </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> non_expired_grant</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">condition non_expired_grant</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">current_time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> grant_time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> grant_duration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> duration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    current_time </span><span class="token operator">&lt;</span><span class="token plain"> grant_time </span><span class="token operator">+</span><span class="token plain"> grant_duration</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we write the following tuples:</p><table><thead><tr><th>user</th><th>relation</th><th>object</th><th>condition</th></tr></thead><tbody><tr><td>user:bob</td><td>viewer</td><td>document:1</td><td></td></tr><tr><td>user:anne</td><td>viewer</td><td>document:1</td><td><code>name</code> : <code>non_expired_grant</code>, <code>context</code> : { <code>grant_time</code> : <code>2023-01-01T00:00:00Z</code>, <code>grant_duration</code> : <code>1h</code> }</td></tr></tbody></table><p>You'll get the following results for the <a href="https://openfga.dev/api/service#/Relationship%20Queries/Check" target="_blank" rel="noopener noreferrer">Check</a> operations below:</p><table><thead><tr><th>user</th><th>relation</th><th>object</th><th>context</th><th>result</th></tr></thead><tbody><tr><td>user:bob</td><td>viewer</td><td>document:1</td><td></td><td><code>allowed</code> : <code>true</code></td></tr><tr><td>user:anne</td><td>viewer</td><td>document:1</td><td><code>current_time</code> : <code>2023-01-01T00:10:00Z</code></td><td><code>allowed</code> : <code>true</code></td></tr><tr><td>11 user:anne</td><td>viewer</td><td>document:1</td><td><code>current_time</code> : <code>2023-01-01T02:00:00Z</code></td><td><code>allowed</code> : <code>false</code></td></tr><tr><td>user:anne</td><td>viewer</td><td>document:1</td><td></td><td><code>error</code> : "failed to evaluate relationship condition 'non_expired_grant': context is missing parameters '<!-- -->[current_time]<!-- -->'</td></tr></tbody></table><p>You'll get the following results for the <a href="https://openfga.dev/api/service#/Relationship%20Queries/ListObjects" target="_blank" rel="noopener noreferrer">ListObjects</a> operations below:</p><table><thead><tr><th>user</th><th>relation</th><th>object</th><th>context</th><th>result</th></tr></thead><tbody><tr><td>user:anne</td><td>viewer</td><td>document:1</td><td><code>current_time</code> : <code>2023-01-01T00:10:00Z</code></td><td><code>objects</code>: <code>[ "document:1"]</code></td></tr><tr><td>user:anne</td><td>viewer</td><td>document:1</td><td></td><td><code>error</code>: "failed to evaluate relationship condition 'non_expired_grant': tuple 'document:1#viewer@user:anne' is missing context parameters '<!-- -->[current_time]<!-- -->'</td></tr></tbody></table><p>Note that:</p><ul><li><code>user:bob</code> will always get <code>allowed:true</code> as we has assigned as as viewer unconditionally.</li><li><code>user:anne</code> will get <code>allowed:true</code> if the <code>current_time</code> is before the <code>grant_time</code> + <code>grant_duration</code> and <code>allowed:false</code> otherwise.</li><li>If you don't provide the <code>current_time</code> in the context, the Check and ListObjects operations will fail.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use Cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use Cases" title="Direct link to Use Cases">​</a></h2><p>The <a href="https://github.com/openfga/sample-stores" target="_blank" rel="noopener noreferrer">OpenFGA Sample Stores repository</a> has several examples that take advantage of this new feature:</p><ul><li><a href="https://github.com/openfga/sample-stores/tree/main/stores/temporal-access" target="_blank" rel="noopener noreferrer">Granting access during a specific period of time (the use case explained above)</a>.</li><li><a href="https://github.com/openfga/sample-stores/tree/main/stores/ip-based-access" target="_blank" rel="noopener noreferrer">Allow access based on the user’s IP Address</a>.</li><li><a href="https://github.com/openfga/sample-stores/tree/main/stores/groups-resource-attributes" target="_blank" rel="noopener noreferrer">Granting access based on group membership and resource attributes</a>.</li><li><a href="https://github.com/openfga/sample-stores/tree/main/stores/advanced-entitlements" target="_blank" rel="noopener noreferrer">Allow access to specific features based on usage</a>.</li><li><a href="https://github.com/openfga/sample-stores/tree/main/stores/banking" target="_blank" rel="noopener noreferrer">Determine if a user can make a bank transfer based .on the transaction amount</a>.</li><li><a href="https://github.com/openfga/sample-stores/tree/main/stores/condition-data-types" target="_blank" rel="noopener noreferrer">Data types and operations supported in conditions</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use-it">How to use it?<a href="#how-to-use-it" class="hash-link" aria-label="Direct link to How to use it?" title="Direct link to How to use it?">​</a></h2><p>Conditional Relationship Tuples are included in OpenFGA 1.4 RC version. You can run it by pulling it from docker:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker pull openfga/openfga:v1.4.0-rc1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker run -p 8080:8080 -p 8081:8081 -p 3000:3000 openfga/openfga:v1.4.0-rc1 run`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>OpenFGA has a rich ecosystem of developer tools. The following have been updated to support Conditional Relationship Tuples:</p><ul><li><p><a href="https://marketplace.visualstudio.com/items?itemName=openfga.openfga-vscode" target="_blank" rel="noopener noreferrer">Visual Studio Code integration</a> which provides syntax highlighting and model validations for conditions.</p></li><li><p>Beta version of the <a href="https://www.npmjs.com/package/@openfga/sdk/v/0.3.0-beta.1" target="_blank" rel="noopener noreferrer">Javscript SDK</a> and the <a href="https://github.com/openfga/go-sdk/releases/tag/v0.3.0-beta.1" target="_blank" rel="noopener noreferrer">Go SDK</a>, which allows using the additional parameters.</p></li><li><p>The <a href="https://github.com/openfga/cli" target="_blank" rel="noopener noreferrer">OpenFGA CLI</a> allows validate models and run tests that use conditional tuples. You can use it to test the new features by pointing to a “fga.yaml” file that <a href="https://github.com/openfga/cli#run-tests-on-an-authorization-model" target="_blank" rel="noopener noreferrer">defines the tests you want to run</a>, without having to deploy OpenFGA.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What’s Next?<a href="#whats-next" class="hash-link" aria-label="Direct link to What’s Next?" title="Direct link to What’s Next?">​</a></h2><p>We’ll address some limitations of the current implementation:</p><ul><li>The Expand() API does not consider conditions.</li><li>The Visual Studio Code integration is not validating the expressions in conditions. </li></ul><p>We'll also improve ListObjects scenarios when it's called with missing context.  For example, consider the following model that enables access only to documents with a specific status:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> document</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    relations</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      define can_access</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">user </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> docs_in_draft_status</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  condition docs_in_draft_status</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">status</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    status </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"draft"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you want to list all the documents a user can view, you'll need to know the status of all of those documents. Given you don't know the documents the user has access too, you can't send the status of those as a parameter to ListObjects.</p><p>Our goal is to return a structure that you can use to filter documents on your side, similar to <code>(document.id = ‘1’ and document.status = ‘draft’) or 
(document.id = ‘2’ and.status = draft)</code>. This won’t scale to a large number of documents, but would be useful in some scenarios.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="we-want-to-learn-from-you">We want to learn from you!<a href="#we-want-to-learn-from-you" class="hash-link" aria-label="Direct link to We want to learn from you!" title="Direct link to We want to learn from you!">​</a></h2><p>We want to learn how you use this feature and how we can improve it! </p><p>Please reach out to us in <a href="https://discord.gg/8naAwJfWN6" target="_blank" rel="noopener noreferrer">Discord</a> or <a href="https://github.com/orgs/openfga/discussions" target="_blank" rel="noopener noreferrer">Github</a> with any questions or feedback.</p>]]></content>
        <author>
            <name>Andres Aguiar</name>
            <uri>https://github.com/aaguiarz</uri>
        </author>
        <category label="openfga" term="openfga"/>
        <category label="features" term="features"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Join the OpenFGA team at KubeCon NA 2023]]></title>
        <id>https://openfga.dev/blog/kubecon-na-2023</id>
        <link href="https://openfga.dev/blog/kubecon-na-2023"/>
        <updated>2023-10-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[OpenFGA at KubeCon]]></summary>
        <content type="html"><![CDATA[<p>As you'd expect, the OpenFGA team will be at KubeCon NA 2023 in Chicago, IL!</p><p>We'll have a packed agenda for the week:</p><ul><li><p><a href="https://www.linkedin.com/in/jonathan-whitaker-5a8b2484/" target="_blank" rel="noopener noreferrer">Jonathan Whitaker</a> and <a href="https://www.linkedin.com/in/luxas/" target="_blank" rel="noopener noreferrer">Lucas Käldström</a> will be presenting in <a href="https://cloud-native.rejekts.io/" target="_blank" rel="noopener noreferrer">Could_Native Rejects</a> on how to use OpenFGA to manage and extend authorization in Kubernetes. Learn more <a href="https://cfp.cloud-native.rejekts.io/cloud-native-rejekts-na-chicago-2023/speaker/XB7EUR/" target="_blank" rel="noopener noreferrer">here</a>.</p></li><li><p><a href="https://www.linkedin.com/in/miparnisari/" target="_blank" rel="noopener noreferrer">Maria Ines Parnisari</a> and <a href="https://www.linkedin.com/in/aaguiar/" target="_blank" rel="noopener noreferrer">Andres Aguiar</a> will be presenting in <a href="https://events.linuxfoundation.org/kubecon-cloudnativecon-north-america/co-located-events/appdevelopercon/" target="_blank" rel="noopener noreferrer">AppDeveloperCon</a> about modernizing authorization for cloud native applications using OpenFGA. Learn more <a href="https://colocatedeventsna2023.sched.com/event/1Rj2j/modernizing-authorization-for-cloud-native-applications-using-openfga-andres-aguiar-maria-ines-parnisari-okta" target="_blank" rel="noopener noreferrer">here</a>.</p></li><li><p>We'll host a Project Meeting on Monday 9.30 AM in the Hudson room at the <a href="https://maps.app.goo.gl/77FwgGdpsWK5jWHd6" target="_blank" rel="noopener noreferrer">Hilton Garden Inn</a>. We'll share how the product is being used, demo the latests features like our new CLI, the VS Code Extension, Conditional Relationships, the Java SDK... and more! </p></li><li><p>We'll be in the CNCF Project Pavilion during the afternoons.</p></li><li><p>We'll host our <a href="https://github.com/openfga/community/blob/main/community-meetings.md" target="_blank" rel="noopener noreferrer">OpenFGA community meeting</a> directly from KubeCon on Thursday 9th  at 3PM UTC (8AM PST/11AM EST).</p></li></ul><p>If you want to meet with the team outside of these events, please pick any spot that works for you in our <a href="https://calendar.app.google/GonEwLboKvPkG8pL6" target="_blank" rel="noopener noreferrer">calendar</a>.</p><p>See you in Chicago!</p>]]></content>
        <author>
            <name>Andres Aguiar</name>
            <uri>https://github.com/aaguiarz</uri>
        </author>
        <category label="conferences" term="conferences"/>
        <category label="kubecon" term="kubecon"/>
    </entry>
</feed>