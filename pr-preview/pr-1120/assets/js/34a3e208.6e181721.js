"use strict";(self.webpackChunkopenfga_dev=self.webpackChunkopenfga_dev||[]).push([[9547],{91737:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>h,contentTitle:()=>c,default:()=>g,frontMatter:()=>d,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"content/getting-started/update-tuples","title":"Update Relationship Tuples","description":"Introduction to adding and deleting relationship tuples","source":"@site/docs/content/getting-started/update-tuples.mdx","sourceDirName":"content/getting-started","slug":"/getting-started/update-tuples","permalink":"/pr-preview/pr-1120/docs/getting-started/update-tuples","draft":false,"unlisted":false,"editUrl":"https://github.com/openfga/openfga.dev/edit/main/docs/content/getting-started/update-tuples.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Update Relationship Tuples","sidebar_position":3,"slug":"/getting-started/update-tuples","description":"Introduction to adding and deleting relationship tuples"},"sidebar":"docs","previous":{"title":"Configure Authorization Model","permalink":"/pr-preview/pr-1120/docs/getting-started/configure-model"},"next":{"title":"Perform a Check","permalink":"/pr-preview/pr-1120/docs/getting-started/perform-check"}}');var s=i(74848),l=i(28453),r=i(25558),a=i(11470),o=i(19365);const d={title:"Update Relationship Tuples",sidebar_position:3,slug:"/getting-started/update-tuples",description:"Introduction to adding and deleting relationship tuples"},c="Update Relationship Tuples",h={},u=[{value:"Before you start",id:"before-you-start",level:2},{value:"Step by step",id:"step-by-step",level:2},{value:"01. Configure the <ProductName></ProductName> API client",id:"01-configure-the--api-client",level:3},{value:"02. Calling write API to add new relationship tuples",id:"02-calling-write-api-to-add-new-relationship-tuples",level:3},{value:"03. Calling write API to delete relationship tuples",id:"03-calling-write-api-to-delete-relationship-tuples",level:3},{value:"04. Writing and deleting relationship tuples in the same request",id:"04-writing-and-deleting-relationship-tuples-in-the-same-request",level:3},{value:"05. Ignoring duplicate or missing tuples",id:"05-ignoring-duplicate-or-missing-tuples",level:3},{value:"Related Sections",id:"related-sections",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"update-relationship-tuples",children:"Update Relationship Tuples"})}),"\n",(0,s.jsx)(r.ZE,{}),"\n",(0,s.jsxs)(n.p,{children:["This is an introduction to adding and deleting ",(0,s.jsx)(n.em,{children:(0,s.jsx)(r.OK,{section:"what-is-a-relationship-tuple",linkName:"relationship tuples"})}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"before-you-start",children:"Before you start"}),"\n",(0,s.jsxs)(a.A,{groupId:"languages",children:[(0,s.jsx)(o.A,{value:r.NH.JS_SDK,label:r.px.get(r.NH.JS_SDK),children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(r.iz,{}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsx)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/install-sdk",children:"installed the SDK"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsxs)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/configure-model",children:["configured the ",(0,s.jsx)(n.em,{children:"authorization model"})]}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have loaded ",(0,s.jsx)(n.code,{children:"FGA_STORE_ID"})," and ",(0,s.jsx)(n.code,{children:"FGA_API_URL"})," as environment variables."]}),"\n"]})}),(0,s.jsx)(o.A,{value:r.NH.GO_SDK,label:r.px.get(r.NH.GO_SDK),children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(r.iz,{}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsx)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/install-sdk",children:"installed the SDK"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsxs)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/configure-model",children:["configured the ",(0,s.jsx)(n.em,{children:"authorization model"})]}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have loaded ",(0,s.jsx)(n.code,{children:"FGA_STORE_ID"})," and ",(0,s.jsx)(n.code,{children:"FGA_API_URL"})," as environment variables."]}),"\n"]})}),(0,s.jsx)(o.A,{value:r.NH.DOTNET_SDK,label:r.px.get(r.NH.DOTNET_SDK),children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(r.iz,{}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsx)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/install-sdk",children:"installed the SDK"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsxs)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/configure-model",children:["configured the ",(0,s.jsx)(n.em,{children:"authorization model"})]}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have loaded ",(0,s.jsx)(n.code,{children:"FGA_STORE_ID"})," and ",(0,s.jsx)(n.code,{children:"FGA_API_URL"})," as environment variables."]}),"\n"]})}),(0,s.jsx)(o.A,{value:r.NH.PYTHON_SDK,label:r.px.get(r.NH.PYTHON_SDK),children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(r.iz,{}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsx)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/install-sdk",children:"installed the SDK"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsxs)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/configure-model",children:["configured the ",(0,s.jsx)(n.em,{children:"authorization model"})]}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have loaded ",(0,s.jsx)(n.code,{children:"FGA_STORE_ID"})," and ",(0,s.jsx)(n.code,{children:"FGA_API_URL"})," as environment variables."]}),"\n"]})}),(0,s.jsx)(o.A,{value:r.NH.JAVA_SDK,label:r.px.get(r.NH.JAVA_SDK),children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(r.iz,{}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsx)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/install-sdk",children:"installed the SDK"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsxs)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/configure-model",children:["configured the ",(0,s.jsx)(n.em,{children:"authorization model"})]}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have loaded ",(0,s.jsx)(n.code,{children:"FGA_STORE_ID"})," and ",(0,s.jsx)(n.code,{children:"FGA_API_URL"})," as environment variables."]}),"\n"]})}),(0,s.jsx)(o.A,{value:r.NH.CLI,label:r.px.get(r.NH.CLI),children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(r.iz,{}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsxs)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/configure-model",children:["configured the ",(0,s.jsx)(n.em,{children:"authorization model"})]}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have loaded ",(0,s.jsx)(n.code,{children:"FGA_STORE_ID"})," and ",(0,s.jsx)(n.code,{children:"FGA_API_URL"})," as environment variables."]}),"\n"]})}),(0,s.jsx)(o.A,{value:r.NH.CURL,label:r.px.get(r.NH.CURL),children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(r.iz,{}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["You have ",(0,s.jsxs)(n.a,{href:"/pr-preview/pr-1120/docs/getting-started/configure-model",children:["configured the ",(0,s.jsx)(n.em,{children:"authorization model"})]}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You have loaded ",(0,s.jsx)(n.code,{children:"FGA_STORE_ID"})," and ",(0,s.jsx)(n.code,{children:"FGA_API_URL"})," as environment variables."]}),"\n"]})})]}),"\n",(0,s.jsx)(n.h2,{id:"step-by-step",children:"Step by step"}),"\n",(0,s.jsxs)(n.p,{children:["Assume that you want to add user ",(0,s.jsx)(n.code,{children:"user:anne"})," to have relationship ",(0,s.jsx)(n.code,{children:"reader"})," with object ",(0,s.jsx)(n.code,{children:"document:Z"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:"{\n  user: 'user:anne',\n  relation: 'reader',\n  object: 'document:Z'\n}\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"01-configure-the--api-client",children:["01. Configure the ",(0,s.jsx)(r.bU,{format:r.Ed.ShortForm})," API client"]}),"\n",(0,s.jsx)(n.p,{children:"Before calling the write API, you will need to configure the API client."}),"\n",(0,s.jsxs)(a.A,{groupId:"languages",children:[(0,s.jsx)(o.A,{value:r.NH.JS_SDK,label:r.px.get(r.NH.JS_SDK),children:(0,s.jsx)(r.nD,{lang:r.NH.JS_SDK})}),(0,s.jsx)(o.A,{value:r.NH.GO_SDK,label:r.px.get(r.NH.GO_SDK),children:(0,s.jsx)(r.nD,{lang:r.NH.GO_SDK})}),(0,s.jsx)(o.A,{value:r.NH.DOTNET_SDK,label:r.px.get(r.NH.DOTNET_SDK),children:(0,s.jsx)(r.nD,{lang:r.NH.DOTNET_SDK})}),(0,s.jsx)(o.A,{value:r.NH.PYTHON_SDK,label:r.px.get(r.NH.PYTHON_SDK),children:(0,s.jsx)(r.nD,{lang:r.NH.PYTHON_SDK})}),(0,s.jsx)(o.A,{value:r.NH.JAVA_SDK,label:r.px.get(r.NH.JAVA_SDK),children:(0,s.jsx)(r.nD,{lang:r.NH.JAVA_SDK})}),(0,s.jsx)(o.A,{value:r.NH.CLI,label:r.px.get(r.NH.CLI),children:(0,s.jsx)(r.nD,{lang:r.NH.CLI})}),(0,s.jsxs)(o.A,{value:r.NH.CURL,label:r.px.get(r.NH.CURL),children:[(0,s.jsxs)(n.p,{children:["To obtain the ",(0,s.jsx)(n.a,{href:"https://auth0.com/docs/get-started/authentication-and-authorization-flow/client-credentials-flow/call-your-api-using-the-client-credentials-flow",children:"access token"}),":"]}),(0,s.jsx)(r.nD,{lang:r.NH.CURL})]})]}),"\n",(0,s.jsx)(n.h3,{id:"02-calling-write-api-to-add-new-relationship-tuples",children:"02. Calling write API to add new relationship tuples"}),"\n",(0,s.jsx)(n.p,{children:"To add the relationship tuples, we can invoke the write API."}),"\n",(0,s.jsx)(r.dp,{relationshipTuples:[{user:"user:anne",relation:"reader",object:"document:Z"}],skipSetup:!0,allowedLanguages:[r.NH.JS_SDK,r.NH.GO_SDK,r.NH.DOTNET_SDK,r.NH.PYTHON_SDK,r.NH.JAVA_SDK,r.NH.CLI,r.NH.CURL]}),"\n",(0,s.jsx)(n.h3,{id:"03-calling-write-api-to-delete-relationship-tuples",children:"03. Calling write API to delete relationship tuples"}),"\n",(0,s.jsx)(n.p,{children:"To delete relationship tuples, we can invoke the write API."}),"\n",(0,s.jsxs)(n.p,{children:["Assume that you want to delete user ",(0,s.jsx)(n.code,{children:"user:anne"}),"'s ",(0,s.jsx)(n.code,{children:"reader"})," relationship with object ",(0,s.jsx)(n.code,{children:"document:Z"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:"{\n  user: 'user:anne',\n  relation: 'reader',\n  object: 'document:Z'\n}\n"})}),"\n",(0,s.jsx)(r.dp,{deleteRelationshipTuples:[{user:"user:anne",relation:"reader",object:"document:Z"}],skipSetup:!0,allowedLanguages:[r.NH.JS_SDK,r.NH.GO_SDK,r.NH.DOTNET_SDK,r.NH.PYTHON_SDK,r.NH.JAVA_SDK,r.NH.CLI,r.NH.CURL]}),"\n",(0,s.jsx)(n.h3,{id:"04-writing-and-deleting-relationship-tuples-in-the-same-request",children:"04. Writing and deleting relationship tuples in the same request"}),"\n",(0,s.jsx)(n.p,{children:"You can combine both writes and deletes in a single transactional API request. This is useful when you need to update multiple relationships atomically. All operations in the request will either succeed together or fail together."}),"\n",(0,s.jsxs)(n.p,{children:["The Write API allows you to send up to ",(0,s.jsx)(n.code,{children:"100"})," unique tuples in the request. (This limit applies to the sum of both writes and deletes in that request)."]}),"\n",(0,s.jsxs)(n.p,{children:["For example, you might want to remove ",(0,s.jsx)(n.code,{children:"user:anne"})," as a ",(0,s.jsx)(n.code,{children:"writer"})," of ",(0,s.jsx)(n.code,{children:"document:Z"})," while simultaneously updating ",(0,s.jsx)(n.code,{children:"user:anne"})," as an ",(0,s.jsx)(n.code,{children:"reader"})," of ",(0,s.jsx)(n.code,{children:"document:Z"}),":"]}),"\n",(0,s.jsx)(r.dp,{relationshipTuples:[{user:"user:anne",relation:"reader",object:"document:Z"}],deleteRelationshipTuples:[{user:"user:anne",relation:"writer",object:"document:Z"}],skipSetup:!0,allowedLanguages:[r.NH.JS_SDK,r.NH.GO_SDK,r.NH.DOTNET_SDK,r.NH.PYTHON_SDK,r.NH.JAVA_SDK,r.NH.CLI,r.NH.CURL]}),"\n",(0,s.jsx)(n.p,{children:"This approach ensures that both operations succeed or fail together, maintaining transactional data consistency."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["When using the Write API, you cannot include the same tuple (same user, relation, and object) in the writes or deletes arrays within a single request. The API will return an error with code ",(0,s.jsx)(n.code,{children:"cannot_allow_duplicate_tuples_in_one_request"})," if detected."]})}),"\n",(0,s.jsx)(n.h3,{id:"05-ignoring-duplicate-or-missing-tuples",children:"05. Ignoring duplicate or missing tuples"}),"\n",(0,s.jsxs)(n.p,{children:["Sometimes you might need to write a tuple that already exists, which would normally cause the whole request to fail. You can use the ",(0,s.jsx)(n.code,{children:'on_duplicate: "ignore"'})," parameter to handle this gracefully."]}),"\n",(0,s.jsx)(n.p,{children:"This is particularly useful for high-volume data imports, migrations, or ensuring certain permissions exist without complex error handling logic."}),"\n",(0,s.jsxs)(n.p,{children:["For example, if you want to ensure ",(0,s.jsx)(n.code,{children:"user:anne"})," has ",(0,s.jsx)(n.code,{children:"reader"})," access to ",(0,s.jsx)(n.code,{children:"document:Z"})," without worrying about whether the relationship already exists in ",(0,s.jsx)(r.bU,{format:r.Ed.ShortForm}),":"]}),"\n",(0,s.jsx)(r.dp,{relationshipTuples:[{user:"user:anne",relation:"reader",object:"document:Z"}],writeOptions:{on_duplicate:"ignore"},skipSetup:!0,allowedLanguages:[r.NH.CURL]}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsx)(n.p,{children:"At the moment, this feature is only available on the API (v1.10.0). Supported SDKs will follow shortly after."})}),"\n",(0,s.jsxs)(n.p,{children:["Similarly, you can use ",(0,s.jsx)(n.code,{children:'on_missing: "ignore"'})," when deleting tuples that might not exist."]}),"\n",(0,s.jsx)(r.dp,{skipSetup:!0,deleteRelationshipTuples:[{user:"user:anne",relation:"writer",object:"document:Z"}],deleteOptions:{on_missing:"ignore"},expectedResponse:{data:{}},allowedLanguages:[r.NH.CURL]}),"\n",(0,s.jsxs)(n.p,{children:["The behavior of ",(0,s.jsx)(n.code,{children:'on_duplicate: "ignore"'})," is more nuanced for tuples with conditions."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Identical Tuples"}),": If a tuple in the request is identical to an existing tuple (same user, relation, object, condition name, and condition context), it will be safely ignored."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Conflicting Tuples"}),": If a tuple key (user, relation, object) matches an existing tuple, but the condition name or parameters are different, this is a conflict. The write attempt will be rejected, and the entire transaction will fail with a ",(0,s.jsx)(n.code,{children:"409 Conflict"})," error."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"related-sections",children:"Related Sections"}),"\n",(0,s.jsx)(r.XQ,{description:"Check the following sections for more on how to write your authorization data",relatedLinks:[{title:"Write API",description:"Learn more about the Write API options.",link:"/api/service#Relationship%20Tuples/Write"},{title:"Managing User Access",description:"Learn about how to give a user access to a particular object.",link:"../interacting/managing-user-access",id:"../interacting/managing-user-access.mdx"},{title:"Managing Group Access",description:"Learn about how to give a group of users access to a particular object.",link:"../interacting/managing-group-access",id:"../interacting/managing-group-access.mdx"}]})]})}function g(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}}}]);