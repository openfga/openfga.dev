"use strict";(self.webpackChunkopenfga_dev=self.webpackChunkopenfga_dev||[]).push([[9952],{72759:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"content/modeling/blocklists","title":"Blocklists","description":"Preventing certain users from accessing objects","source":"@site/docs/content/modeling/blocklists.mdx","sourceDirName":"content/modeling","slug":"/modeling/blocklists","permalink":"/pr-preview/pr-1172/docs/modeling/blocklists","draft":false,"unlisted":false,"editUrl":"https://github.com/openfga/openfga.dev/edit/main/docs/content/modeling/blocklists.mdx","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"slug":"/modeling/blocklists","description":"Preventing certain users from accessing objects"},"sidebar":"docs","previous":{"title":"Parent-Child Objects","permalink":"/pr-preview/pr-1172/docs/modeling/parent-child"},"next":{"title":"Public Access","permalink":"/pr-preview/pr-1172/docs/modeling/public-access"}}');var s=t(74848),i=t(28453),r=t(25558);const a={sidebar_position:8,slug:"/modeling/blocklists",description:"Preventing certain users from accessing objects"},c="Blocklists",l={},d=[{value:"Before you start",id:"before-you-start",level:2},{value:"Step by step",id:"step-by-step",level:2},{value:"01. Modify our model so users can be blocked from accessing a document",id:"01-modify-our-model-so-users-can-be-blocked-from-accessing-a-document",level:3},{value:"02. Modify our model so users who are blocked can no longer edit the document",id:"02-modify-our-model-so-users-who-are-blocked-can-no-longer-edit-the-document",level:3},{value:"03. Verify our solution works",id:"03-verify-our-solution-works",level:3},{value:"a. Indicate that Carl is blocked from the planning document",id:"a-indicate-that-carl-is-blocked-from-the-planning-document",level:4},{value:"b. Carl (now blocked) can no longer edit the document",id:"b-carl-now-blocked-can-no-longer-edit-the-document",level:4},{value:"Related Sections",id:"related-sections",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"blocklists",children:"Blocklists"})}),"\n",(0,s.jsx)(r.ZE,{}),"\n",(0,s.jsxs)(n.p,{children:["In this guide you'll see how to model preventing users from accessing objects using ",(0,s.jsx)(r.bU,{format:r.Ed.ProductLink}),". For example, ",(0,s.jsx)(n.code,{children:"blocking"})," users from accessing a ",(0,s.jsx)(n.code,{children:"document"}),", even if it has been already shared with them."]}),"\n",(0,s.jsxs)(r.u6,{title:"When to use",appearance:"filled",children:[(0,s.jsx)(n.p,{children:"Exclusion is useful while building applications. You may need to support access patterns like granting access to some users, but excluding specific people or groups, similar to how users can block others from following them on social media, or prevent them from sharing documents on Google Drive."}),(0,s.jsx)(n.p,{children:"This is useful when:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'Implementing the "blocking" feature, such as the profile blocking commonly present on social media platforms (e.g. Instagram and Twitter).'}),"\n",(0,s.jsx)(n.li,{children:"Reduce a user's access if they are part of a particular group (e.g. restricting access to members who are also guests, or restricting access to users in a certain locality)."}),"\n"]})]}),"\n",(0,s.jsx)(n.h2,{id:"before-you-start",children:"Before you start"}),"\n",(0,s.jsxs)(n.p,{children:["Before you start this guide, make sure you're familiar with some ",(0,s.jsx)(r.OK,{})," and know how to develop the things listed below."]}),"\n",(0,s.jsxs)(n.p,{children:["You will start with the ",(0,s.jsx)(n.em,{children:(0,s.jsx)(r.OK,{section:"what-is-an-authorization-model",linkName:"authorization model"})})," below, it represents a ",(0,s.jsx)(n.code,{children:"document"})," ",(0,s.jsx)(n.em,{children:(0,s.jsx)(r.OK,{section:"what-is-a-type",linkName:"type"})})," that can have users ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(r.OK,{section:"what-is-a-relation",linkName:"related"})})," as ",(0,s.jsx)(n.code,{children:"editor"}),", and ",(0,s.jsx)(n.code,{children:"team"})," type that can have users related as ",(0,s.jsx)(n.code,{children:"member"}),"."]}),"\n",(0,s.jsx)(r.pB,{configuration:{schema_version:"1.1",type_definitions:[{type:"user"},{type:"document",relations:{editor:{this:{}}},metadata:{relations:{editor:{directly_related_user_types:[{type:"user"},{type:"team",relation:"member"}]}}}},{type:"team",relations:{member:{this:{}}},metadata:{relations:{member:{directly_related_user_types:[{type:"user"}]}}}}]}}),"\n",(0,s.jsxs)(n.p,{children:["Let us also assume that we have a ",(0,s.jsx)(n.code,{children:"document"}),' called "planning", shared for editing within the product ',(0,s.jsx)(n.code,{children:"team"})," (comprised of becky and carl)."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"  # Becky is a member of the product team\n  - user: user:becky\n    relation: member\n    object: team:product\n\n  # Carl is a member of the product team\n  - user: user:carl\n    relation: member\n    object: team:product\n\n  # Members of the product team can edit the planning document\n  - user: team:product#member\n    relation: editor\n    object: document:planning\n"})}),"\n",(0,s.jsx)("hr",{}),"\n",(0,s.jsx)(n.h2,{id:"step-by-step",children:"Step by step"}),"\n",(0,s.jsxs)(n.p,{children:["With the above authorization model and relationship tuples, ",(0,s.jsx)(r.bU,{format:r.Ed.LongForm})," will correctly respond with ",(0,s.jsx)(n.code,{children:'{"allowed":true}'})," when ",(0,s.jsx)(r.OK,{section:"what-is-a-check-request",linkName:"check"})," is called to see if Carl and Becky can edit this ",(0,s.jsx)(n.code,{children:"document"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"We can verify that with these two tests which will pass:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"tests:\n  - name: \"Becky can edit the 'planning' document\"\n    check:\n      - user: user:becky\n        object: document:planning\n        assertions:\n          editor: true\n  - name: \"Carl can edit the 'planning' document\"\n    check:\n      - user: user:carl\n        object: document:planning\n        assertions:\n          editor: true\n"})}),"\n",(0,s.jsx)(n.p,{children:"We want to share a document with the product team and also have the ability to deny certain users access, even if they have the document shared with them already. We can verify this by blocking Carl (who we have seen already has edit access) from editing the document."}),"\n",(0,s.jsx)(n.p,{children:"In order to do that, we need to:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#01-modify-our-model-so-users-can-be-blocked-from-accessing-a-document",children:"Modify our model to allow indicating that users can be blocked from accessing a document"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#02-modify-our-model-so-users-who-are-blocked-can-no-longer-edit-the-document",children:"Modify our model to indicate that users who are blocked can no longer edit the document"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#03-verify-our-solution-works",children:"Verify that our solution works"}),":"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["a. ",(0,s.jsx)(n.a,{href:"#a-indicate-that-carl-is-blocked-from-the-planning-document",children:"Indicate that Carl is blocked from the planning document"})]}),"\n",(0,s.jsxs)(n.p,{children:["b. ",(0,s.jsx)(n.a,{href:"#b-carl-now-blocked-can-no-longer-edit-the-document",children:"Carl (now blocked) can no longer edit the document"}),", but Becky still has edit access"]}),"\n",(0,s.jsx)(n.h3,{id:"01-modify-our-model-so-users-can-be-blocked-from-accessing-a-document",children:"01. Modify our model so users can be blocked from accessing a document"}),"\n",(0,s.jsxs)(n.p,{children:['To allow users to be "blocked" from accessing a ',(0,s.jsx)(n.code,{children:"document"}),", we first need to allow this relation. We'll update our store model to add a ",(0,s.jsx)(n.code,{children:"blocked"})," ",(0,s.jsx)(r.OK,{section:"what-is-a-relation",linkName:"relation"})," to the ",(0,s.jsx)(n.code,{children:"document"})," type."]}),"\n",(0,s.jsx)(n.p,{children:"The authorization model becomes this:"}),"\n",(0,s.jsx)(r.pB,{configuration:{schema_version:"1.1",type_definitions:[{type:"user"},{type:"document",relations:{blocked:{this:{}},editor:{this:{}}},metadata:{relations:{blocked:{directly_related_user_types:[{type:"user"}]},editor:{directly_related_user_types:[{type:"user"},{type:"team",relation:"member"}]}}}},{type:"team",relations:{member:{this:{}}},metadata:{relations:{member:{directly_related_user_types:[{type:"user"}]}}}}]}}),"\n",(0,s.jsxs)(n.p,{children:["Now we can add relationship tuples indicating that a certain user is ",(0,s.jsx)(n.code,{children:"blocked"})," from editing a ",(0,s.jsx)(n.code,{children:"document"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"02-modify-our-model-so-users-who-are-blocked-can-no-longer-edit-the-document",children:"02. Modify our model so users who are blocked can no longer edit the document"}),"\n",(0,s.jsxs)(n.p,{children:["Now that we can mark users as ",(0,s.jsx)(n.code,{children:"blocked"})," from editing documents, we need to support denying the ",(0,s.jsx)(n.code,{children:"editor"})," relationship when a user is ",(0,s.jsx)(n.code,{children:"blocked"}),". We do that by modifying the relation definition of ",(0,s.jsx)(n.code,{children:"editor"}),", and making use of the ",(0,s.jsx)(n.a,{href:"/pr-preview/pr-1172/docs/configuration-language#the-exclusion-operator",children:(0,s.jsx)(n.strong,{children:"exclusion operator"})})," to exclude the set of ",(0,s.jsx)(n.code,{children:"blocked"})," users, as we can see here:"]}),"\n",(0,s.jsx)(r.pB,{configuration:{schema_version:"1.1",type_definitions:[{type:"user"},{type:"document",relations:{blocked:{this:{}},editor:{difference:{base:{this:{}},subtract:{computedUserset:{relation:"blocked"}}}}},metadata:{relations:{blocked:{directly_related_user_types:[{type:"user"}]},editor:{directly_related_user_types:[{type:"user"},{type:"team",relation:"member"}]}}}},{type:"team",relations:{member:{this:{}}},metadata:{relations:{member:{directly_related_user_types:[{type:"user"}]}}}}]}}),"\n",(0,s.jsx)(n.h3,{id:"03-verify-our-solution-works",children:"03. Verify our solution works"}),"\n",(0,s.jsxs)(n.p,{children:["To check if our new model works, we'll add a relationship tuple with Carl as ",(0,s.jsx)(n.code,{children:"blocked"})," from ",(0,s.jsx)(n.code,{children:"document:planning"})," and then verify that Carl no longer has ",(0,s.jsx)(n.code,{children:"editor"})," access to that document."]}),"\n",(0,s.jsx)(n.h4,{id:"a-indicate-that-carl-is-blocked-from-the-planning-document",children:"a. Indicate that Carl is blocked from the planning document"}),"\n",(0,s.jsxs)(n.p,{children:["With our modified authorization model, we can indicate that Carl is blocked by adding this ",(0,s.jsx)(n.em,{children:(0,s.jsx)(r.OK,{section:"what-is-a-relationship-tuple",linkName:"relationship tuple"})}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"  # Carl is blocked from the planning document\n  - user: user:carl\n    relation: blocked\n    object: document:planning\n"})}),"\n",(0,s.jsx)(n.h4,{id:"b-carl-now-blocked-can-no-longer-edit-the-document",children:"b. Carl (now blocked) can no longer edit the document"}),"\n",(0,s.jsxs)(n.p,{children:["We have modified the authorization model and added relationship tuples to indicate that Carl is ",(0,s.jsx)(n.code,{children:"blocked"}),". Now let's make sure our solution works as expected."]}),"\n",(0,s.jsx)(n.p,{children:"With these tuples, Carl will not be able to edit the document, but Becky will:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"tests:\n  - name: \"Carl can edit the 'planning' document\"\n    check:\n      - user: user:carl\n        object: document:planning\n        assertions:\n          editor: false\n  - name: \"Becky can edit the 'planning' document\"\n    check:\n      - user: user:becky\n        object: document:planning\n        assertions:\n          editor: true\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.p,{children:["When creating tuples for ",(0,s.jsx)(r.bU,{format:r.Ed.LongForm})," make sure to use unique ids for each object and user within your application domain. We are using first names and human-readable identifiers to make this task easier to read."]})}),"\n",(0,s.jsx)(n.h2,{id:"related-sections",children:"Related Sections"}),"\n",(0,s.jsx)(r.XQ,{description:"Check the following sections for more on how to model with {ProductName}.",relatedLinks:[{title:"Modeling: Getting Started",description:"Learn about how to get started with modeling.",link:"./getting-started",id:"./getting-started"},{title:"Configuration Language",description:"Learn about {ProductName} Configuration Language.",link:"../configuration-language",id:"../configuration-language"},{title:"Public Access",description:"Learn about model public access.",link:"./public-access",id:"./public-access"}]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);