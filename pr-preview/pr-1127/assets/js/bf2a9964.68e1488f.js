"use strict";(self.webpackChunkopenfga_dev=self.webpackChunkopenfga_dev||[]).push([[6420],{13155:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"content/getting-started/setup-openfga/troubleshooting-performance","title":"Reporting Performance Issues","description":"Information to gather when reporting OpenFGA performance issues","source":"@site/docs/content/getting-started/setup-openfga/troubleshooting-performance.mdx","sourceDirName":"content/getting-started/setup-openfga","slug":"/getting-started/setup-openfga/reporting-performance-issues","permalink":"/pr-preview/pr-1127/docs/getting-started/setup-openfga/reporting-performance-issues","draft":false,"unlisted":false,"editUrl":"https://github.com/openfga/openfga.dev/edit/main/docs/content/getting-started/setup-openfga/troubleshooting-performance.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Reporting Performance Issues","description":"Information to gather when reporting OpenFGA performance issues","slug":"/getting-started/setup-openfga/reporting-performance-issues","sidebar_position":6},"sidebar":"docs","previous":{"title":"Playground","permalink":"/pr-preview/pr-1127/docs/getting-started/setup-openfga/playground"},"next":{"title":"Install SDK Client","permalink":"/pr-preview/pr-1127/docs/getting-started/install-sdk"}}');var t=i(74848),r=i(28453),o=i(25558);const a={title:"Reporting Performance Issues",description:"Information to gather when reporting OpenFGA performance issues",slug:"/getting-started/setup-openfga/reporting-performance-issues",sidebar_position:6},l="Reporting Performance Issues",c={},d=[{value:"Full Reproduction",id:"full-reproduction",level:2},{value:"Performance Investigation Requirements",id:"performance-investigation-requirements",level:2},{value:"Timeline Of Events",id:"timeline-of-events",level:3},{value:"Authorization Data",id:"authorization-data",level:3},{value:"Authorization Model",id:"authorization-model",level:4},{value:"Relationship Tuples",id:"relationship-tuples",level:4},{value:"Alternative: Simplified Reproduction",id:"alternative-simplified-reproduction",level:4},{value:"OpenFGA Configuration",id:"openfga-configuration",level:3},{value:"Version Information",id:"version-information",level:4},{value:"Configuration Settings",id:"configuration-settings",level:4},{value:"Infrastructure Details",id:"infrastructure-details",level:4},{value:"Load Testing Scenario",id:"load-testing-scenario",level:3},{value:"Load Testing Script",id:"load-testing-script",level:4},{value:"Request Examples",id:"request-examples",level:4},{value:"Performance Expectations",id:"performance-expectations",level:4},{value:"Observability",id:"observability",level:3},{value:"Key Metrics",id:"key-metrics",level:4},{value:"Traces",id:"traces",level:4},{value:"How to Share This Information",id:"how-to-share-this-information",level:3},{value:"Related Sections",id:"related-sections",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"reporting-performance-issues",children:"Reporting Performance Issues"})}),"\n",(0,t.jsx)(o.ZE,{}),"\n",(0,t.jsx)(n.p,{children:"If you're experiencing performance issues with OpenFGA, gathering the right information upfront will help us diagnose the problem. The more details you can share, the faster we can help."}),"\n",(0,t.jsx)(n.p,{children:"This guide outlines the key details necessary to investigate performance-related issues."}),"\n",(0,t.jsx)(n.h2,{id:"full-reproduction",children:"Full Reproduction"}),"\n",(0,t.jsxs)(n.p,{children:["The absolute best way to help us diagnose your performance issue is to provide everything needed to ",(0,t.jsx)(n.strong,{children:"fully reproduce the problem"}),":"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Authorization model"})," (",(0,t.jsx)(n.code,{children:".fga"})," file)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Relationship tuples"})," (export via the ",(0,t.jsx)(n.a,{href:"https://github.com/openfga/cli",children:"OpenFGA CLI"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Script or steps"})," to reproduce the performance problem"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"With these three items, we can recreate your exact scenario in our own environment, which dramatically speeds up diagnosis and resolution."}),"\n",(0,t.jsxs)(n.admonition,{type:"warning",children:[(0,t.jsxs)(n.p,{children:["If you cannot share your real model and tuples due to data sensitivity, consider ",(0,t.jsx)(n.strong,{children:"creating a synthetic reproduction"}),"."]}),(0,t.jsx)(n.p,{children:"Build a simplified model and generate mock tuples that demonstrate the same performance characteristics. This approach still allows us to reproduce the issue without exposing sensitive data."})]}),"\n",(0,t.jsx)(n.p,{children:"If you can provide this information, please see the sections below for details on how to export and share it. If you cannot share this level of detail due to data sensitivity or other constraints, don't worry\u2014the following sections detail alternative information that will still help us investigate your issue."}),"\n",(0,t.jsx)(n.h2,{id:"performance-investigation-requirements",children:"Performance Investigation Requirements"}),"\n",(0,t.jsx)(n.h3,{id:"timeline-of-events",children:"Timeline Of Events"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"When did the performance issue start?"}),"\n",(0,t.jsx)(n.li,{children:"Were there any changes made to your OpenFGA setup around that time? (e.g., model changes, configuration changes, infrastructure changes)"}),"\n",(0,t.jsx)(n.li,{children:"Is the performance issue consistent or intermittent? If intermittent, how often does it occur?"}),"\n",(0,t.jsx)(n.li,{children:"What troubleshooting have you already attempted?"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"authorization-data",children:"Authorization Data"}),"\n",(0,t.jsx)(n.h4,{id:"authorization-model",children:"Authorization Model"}),"\n",(0,t.jsxs)(n.p,{children:["Please provide your current authorization model (",(0,t.jsx)(n.code,{children:".fga"})," file). This helps us understand the complexity of your relationships and potential performance implications."]}),"\n",(0,t.jsx)(n.h4,{id:"relationship-tuples",children:"Relationship Tuples"}),"\n",(0,t.jsx)(n.p,{children:"The best-case scenario is if you can share an export of your relationship tuples. You can get this by running:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"fga tuple read --output-format=csv --max-pages 0 > tuples.csv\n"})}),"\n",(0,t.jsx)(n.h4,{id:"alternative-simplified-reproduction",children:"Alternative: Simplified Reproduction"}),"\n",(0,t.jsxs)(n.p,{children:["If you can't share your real tuples due to data sensitivity, consider creating a ",(0,t.jsx)(n.strong,{children:"mock dataset"})," that reproduces the same performance issue. This allows us to reproduce the problem without handling sensitive information. Generate fake tuples with similar:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Volume"})," (same number of tuples)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Cardinality patterns"})," (i.e. how many or how few objects are related to another object)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Structure"})," (same types and relations)"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"As a last resort, if you can't share tuples directly (real or mock), please provide:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.strong,{children:"cardinality"})," distribution for your most common object type/relation pairs"]}),"\n",(0,t.jsxs)(n.li,{children:["Approximate order of magnitude (hundreds, thousands, millions) ",(0,t.jsx)(n.strong,{children:"counts"})," are fine\u2014we mainly need to understand the scale and distribution of your data"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"openfga-configuration",children:"OpenFGA Configuration"}),"\n",(0,t.jsx)(n.h4,{id:"version-information",children:"Version Information"}),"\n",(0,t.jsx)(n.p,{children:"Which version of OpenFGA are you running? This is critical as performance characteristics can vary significantly between versions."}),"\n",(0,t.jsx)(n.h4,{id:"configuration-settings",children:"Configuration Settings"}),"\n",(0,t.jsxs)(n.p,{children:["Please share your configuration settings (you should omit any secrets). You can find more information on configuration settings in the ",(0,t.jsx)(n.a,{href:"/pr-preview/pr-1127/docs/getting-started/setup-openfga/configure-openfga",children:"Configure OpenFGA documentation"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Key settings we're interested in include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Cache configuration"}),"\n",(0,t.jsx)(n.li,{children:"Concurrency limits"}),"\n",(0,t.jsx)(n.li,{children:"Database connection pool settings"}),"\n",(0,t.jsx)(n.li,{children:"Any performance-related flags you've enabled"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"infrastructure-details",children:"Infrastructure Details"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"OpenFGA nodes"}),": How many OpenFGA nodes/pods are you running? What are the CPU and RAM specs for each?"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Database"}),": Which database are you using (e.g., PostgreSQL, MySQL)? What are its specs (e.g., instance type, vCPU, RAM)?"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"load-testing-scenario",children:"Load Testing Scenario"}),"\n",(0,t.jsx)(n.p,{children:"Understanding how you're testing helps us reproduce and diagnose the issue. Ideally, this would be part of your full reproduction package."}),"\n",(0,t.jsx)(n.h4,{id:"load-testing-script",children:"Load Testing Script"}),"\n",(0,t.jsx)(n.p,{children:"If you're using a load-testing script, please share it. This allows us to reproduce your scenario exactly and is one of the three key components needed for full reproduction."}),"\n",(0,t.jsx)(n.h4,{id:"request-examples",children:"Request Examples"}),"\n",(0,t.jsx)(n.p,{children:"If you don't have a script or cannot share your full reproduction, please provide example requests and responses for the calls that are slow:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Check API calls"}),"\n",(0,t.jsx)(n.li,{children:"Write API calls"}),"\n",(0,t.jsx)(n.li,{children:"ListObjects API calls"}),"\n",(0,t.jsx)(n.li,{children:"ListUsers API calls"}),"\n",(0,t.jsx)(n.li,{children:"Other relevant API calls"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"performance-expectations",children:"Performance Expectations"}),"\n",(0,t.jsx)(n.p,{children:"What are your target p95/p99 response times for these queries? Understanding your requirements helps us determine if there's a performance issue or if expectations need adjustment."}),"\n",(0,t.jsx)(n.h3,{id:"observability",children:"Observability"}),"\n",(0,t.jsx)(n.p,{children:"If you cannot provide a full reproduction, observability data becomes especially valuable for diagnosing your issue."}),"\n",(0,t.jsx)(n.p,{children:"Screenshots from your monitoring dashboards are incredibly helpful! We're most interested in the following metrics, grouped by request type:"}),"\n",(0,t.jsx)(n.h4,{id:"key-metrics",children:"Key Metrics"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Request latency"}),": p50, p95, p99 percentiles"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Database query counts"}),": p50, p95 percentiles"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Requests Per Second (RPS)"}),": Overall throughput"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Database connections"}),": Active and idle connections"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Cache hit ratio"}),": Effectiveness of caching"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Goroutine count"}),": Concurrency patterns"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"traces",children:"Traces"}),"\n",(0,t.jsxs)(n.p,{children:["If you have a specific query that is consistently slow, a ",(0,t.jsx)(n.strong,{children:"trace for that request is the single most valuable piece of information you can provide"}),". Traces allow us to see exactly where time is being spent in the request lifecycle."]}),"\n",(0,t.jsx)(n.h3,{id:"how-to-share-this-information",children:"How to Share This Information"}),"\n",(0,t.jsx)(n.p,{children:"When reporting a performance issue, please:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Create a GitHub issue in the ",(0,t.jsx)(n.a,{href:"https://github.com/openfga/openfga/issues",children:"OpenFGA repository"})]}),"\n",(0,t.jsx)(n.li,{children:'Use the "Performance Issue" template if available'}),"\n",(0,t.jsx)(n.li,{children:"Include as many of the above details as possible"}),"\n",(0,t.jsx)(n.li,{children:"If sharing sensitive information, consider creating sanitized/anonymized versions of your data"}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["The absolute best way to help us diagnose your performance issue is to provide a ",(0,t.jsx)(n.strong,{children:"full reproduction"})," (model + tuples + script). If that's not possible, providing as much of the information above as you can will still help us investigate and resolve your performance issue."]})}),"\n",(0,t.jsx)(n.h2,{id:"related-sections",children:"Related Sections"}),"\n",(0,t.jsx)(o.XQ,{description:"Check the following sections for more on how to configure OpenFGA.",relatedLinks:[{title:"Configuring OpenFGA",description:"Learn more about the different ways to configure OpenFGA",link:"./configure-openfga",id:"./configure-openfga"},{title:"Running OpenFGA in Production",description:"Learn the best practices of running OpenFGA in a production environment",link:"../../best-practices/running-in-production",id:"./best-practices/running-in-production"}]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);