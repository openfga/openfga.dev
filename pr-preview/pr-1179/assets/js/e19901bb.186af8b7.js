"use strict";(globalThis.webpackChunkopenfga_dev=globalThis.webpackChunkopenfga_dev||[]).push([[5866],{29795(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"content/best-practices/modeling-abac","title":"Modeling Attribute Based Access Control","description":"Learn how to model Attribute-Based Access Control (ABAC) patterns using stored and dynamic attributes in OpenFGA.","source":"@site/docs/content/best-practices/modeling-abac.mdx","sourceDirName":"content/best-practices","slug":"/best-practices/modeling-abac","permalink":"/pr-preview/pr-1179/docs/best-practices/modeling-abac","draft":false,"unlisted":false,"editUrl":"https://github.com/openfga/openfga.dev/edit/main/docs/content/best-practices/modeling-abac.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Modeling Attribute Based Access Control","slug":"/best-practices/modeling-abac","description":"Learn how to model Attribute-Based Access Control (ABAC) patterns using stored and dynamic attributes in OpenFGA.","sidebar_position":2},"sidebar":"docs","previous":{"title":"Authorization Model Design Principles","permalink":"/pr-preview/pr-1179/docs/best-practices/modeling-design-principles"},"next":{"title":"Modeling Roles","permalink":"/pr-preview/pr-1179/docs/best-practices/modeling-roles"}}');var i=t(74848),o=t(28453),r=t(25558);const a={title:"Modeling Attribute Based Access Control",slug:"/best-practices/modeling-abac",description:"Learn how to model Attribute-Based Access Control (ABAC) patterns using stored and dynamic attributes in OpenFGA.",sidebar_position:2},c="Modeling ABAC with ",l={},d=[{value:"Stored Attribute Data",id:"stored-attribute-data",level:2},{value:"Modeling Attributes as Relations",id:"modeling-attributes-as-relations",level:3},{value:"Using <code>user:*</code> as a Boolean Flag",id:"using-user-as-a-boolean-flag",level:4},{value:"Using Self-Relations",id:"using-self-relations",level:4},{value:"Storing Attributes in Conditional Tuple Context",id:"storing-attributes-in-conditional-tuple-context",level:3},{value:"Request-Time Attribute Data",id:"request-time-attribute-data",level:2},{value:"Multi-Organization Session Context",id:"multi-organization-session-context",level:3},{value:"Using Contextual Tuples",id:"using-contextual-tuples",level:4},{value:"Using Conditional Relationship Tuples",id:"using-conditional-relationship-tuples",level:4},{value:"Choosing the Right Approach",id:"choosing-the-right-approach",level:2},{value:"Related Sections",id:"related-sections",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsxs)(n.h1,{id:"modeling-abac-with-",children:["Modeling ABAC with ",(0,i.jsx)(r.bU,{format:r.Ed.ShortForm})]})}),"\n",(0,i.jsx)(n.p,{children:'Attribute-Based Access Control (ABAC) extends traditional relationship-based access control by incorporating attributes into authorization decisions. While Role-Based Access Control (RBAC) answers "does this user have this role?", ABAC answers questions like "does this user have this role AND is their email verified?" or "can this user access this resource given their current session context?".'}),"\n",(0,i.jsxs)(n.p,{children:["With ",(0,i.jsx)(r.bU,{format:r.Ed.ShortForm}),", you can model ABAC patterns using attributes that are stored in the system or attributes that are provided dynamically with each authorization request."]}),"\n",(0,i.jsx)(n.p,{children:"This guide covers two main approaches:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Stored attributes"}),": Attributes persisted in ",(0,i.jsx)(r.bU,{format:r.Ed.ShortForm})," as part of your relationship data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Request-time attributes"}),": Dynamic attributes sent with each authorization check request"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"stored-attribute-data",children:"Stored Attribute Data"}),"\n",(0,i.jsxs)(n.p,{children:["When attributes are relatively static and can be stored alongside your relationship data, you can model them directly in ",(0,i.jsx)(r.bU,{format:r.Ed.ShortForm}),'. This approach works well for attributes like "email verified", "SSO enabled", or "account tier".']}),"\n",(0,i.jsx)(n.p,{children:"Consider a scenario where you want to allow users to perform an action only if their organization has SSO enabled. Below are three patterns for modeling this requirement."}),"\n",(0,i.jsx)(n.h3,{id:"modeling-attributes-as-relations",children:"Modeling Attributes as Relations"}),"\n",(0,i.jsxs)(n.h4,{id:"using-user-as-a-boolean-flag",children:["Using ",(0,i.jsx)(n.code,{children:"user:*"})," as a Boolean Flag"]}),"\n",(0,i.jsxs)(n.p,{children:["The simplest approach for boolean attributes is using the ",(0,i.jsx)(n.a,{href:"/pr-preview/pr-1179/docs/modeling/public-access",children:"Public Access"})," pattern. By assigning ",(0,i.jsx)(n.code,{children:"user:*"})," to a relation, you effectively create a boolean flag that applies to all users."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"When to use this approach:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You need a simple true/false flag"}),"\n",(0,i.jsx)(n.li,{children:"The attribute applies uniformly to all users in a context"}),"\n",(0,i.jsx)(n.li,{children:"You want minimal tuple overhead"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dsl.openfga",children:"model: |\n  model\n    schema 1.1\n\n  type user\n  \n  type organization\n    relations\n      define member : [user]\n      define sso_enabled : [user:*]\n      define can_use_sso : sso_enabled and member\n\ntuples:\n  - user: user:*\n    relation: sso_enabled\n    object: organization:acme\n  - user: user:anne\n    relation: member\n    object: organization:acme\n\ntests:\n  - check:\n    - user: user:anne\n      object: organization:acme\n      assertions:\n        can_use_sso: true\n"})}),"\n",(0,i.jsx)(n.h4,{id:"using-self-relations",children:"Using Self-Relations"}),"\n",(0,i.jsx)(n.p,{children:"An alternative approach is to use a self-referential relation, where an object points to itself to indicate an attribute is set. This pattern makes the relationship semantics more explicit."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"When to use this approach:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You want clearer semantics about what the attribute represents"}),"\n",(0,i.jsx)(n.li,{children:"The attribute is a property of the object itself rather than a universal grant"}),"\n",(0,i.jsx)(n.li,{children:"You prefer explicit object references over wildcards"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dsl.openfga",children:"model: |\n  model\n    schema 1.1\n\n  type user\n\n  type organization\n    relations\n      define member : [user]\n      define sso_enabled : [organization]\n      define can_use_sso : member from sso_enabled\n\ntuples:\n  - user: organization:acme\n    relation: sso_enabled\n    object: organization:acme\n\n  - user: user:anne\n    relation: member\n    object: organization:acme\n\ntests:\n  - check:\n    - user: user:anne\n      object: organization:acme\n      assertions:\n        can_use_sso: true\n"})}),"\n",(0,i.jsx)(n.h3,{id:"storing-attributes-in-conditional-tuple-context",children:"Storing Attributes in Conditional Tuple Context"}),"\n",(0,i.jsx)(n.p,{children:"For attributes that require typed values beyond simple booleans, you can store the attribute value directly in the condition context of a relationship tuple. This approach combines the relationship with its associated attribute data."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"When to use this approach:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You need typed attribute values (strings, numbers, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"The attribute is tightly coupled to a specific relationship"}),"\n",(0,i.jsx)(n.li,{children:"You want to avoid additional tuples for attribute storage"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dsl.openfga",children:"model: |\n  model\n    schema 1.1\n    \n  type user\n  \n  type organization\n    relations\n      define member : [user]\n      define sso_enabled : [organization#member with sso_enabled]\n      define can_use_sso : sso_enabled\n\n  condition sso_enabled(sso_enabled: bool) {\n    sso_enabled\n  }\n\ntuples:\n  - user: organization:acme#member\n    relation: sso_enabled\n    object: organization:acme\n    condition:\n      name: sso_enabled\n      context:\n        sso_enabled : true\n\n  - user: user:anne\n    relation: member\n    object: organization:acme\n\ntests:\n  - check:\n    - user: user:anne\n      object: organization:acme\n      assertions:\n        can_use_sso: true\n"})}),"\n",(0,i.jsx)(n.h2,{id:"request-time-attribute-data",children:"Request-Time Attribute Data"}),"\n",(0,i.jsx)(n.p,{children:"Some attributes cannot be stored because they are dynamic and change with each request. Common examples include the current time, client IP address, or the user's current session context. For these scenarios, you provide the attribute values at request time."}),"\n",(0,i.jsxs)(n.p,{children:["For time-based, IP-based conditions and more, see the ",(0,i.jsx)(n.a,{href:"/pr-preview/pr-1179/docs/modeling/conditions",children:"Conditions documentation"})," for detailed examples."]}),"\n",(0,i.jsx)(n.h3,{id:"multi-organization-session-context",children:"Multi-Organization Session Context"}),"\n",(0,i.jsx)(n.p,{children:"A common use case is when users can authenticate to multiple organizations but should only access resources belonging to their currently active organization. When accessing content, you need to verify the content belongs to the organization the user is currently logged into."}),"\n",(0,i.jsx)(n.p,{children:"You can achieve this with either contextual tuples or conditional relationship tuples."}),"\n",(0,i.jsx)(n.h4,{id:"using-contextual-tuples",children:"Using Contextual Tuples"}),"\n",(0,i.jsxs)(n.p,{children:["With this approach, you add a relation (e.g., ",(0,i.jsx)(n.code,{children:"user_in_context"}),") that is not stored but sent as a contextual tuple with each request. This contextual tuple represents the user's current session context."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"When to use this approach:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Session context is determined entirely at request time"}),"\n",(0,i.jsx)(n.li,{children:"You want to keep stored tuples simple and context-free"}),"\n",(0,i.jsx)(n.li,{children:"The context applies across multiple relation checks"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dsl.openfga",children:"model: |\n  model\n    schema 1.1\n\n  type user\n\n  type organization\n    relations\n      define user_in_context: [user]\n      define project_editor: [user] and user_in_context\n      define project_viewer: [user] and user_in_context\n\n  type project\n    relations\n      define organization: [organization]\n      define editor: project_editor from organization\n      define viewer: project_viewer from organization\n\ntuples:\n  - user: user:anne\n    relation: project_editor\n    object: organization:acme\n\n  - user: organization:acme\n    relation: organization\n    object: project:acme-website\n\n  - user: user:anne\n    relation: project_editor\n    object: organization:contoso\n\n  - user: organization:contoso\n    relation: organization\n    object: project:contoso-website\n\ntests:\n  - name: Anne can access the acme-website when she's in context of the acme organization\n    tuples:\n      # This contextual tuple represents Anne's current session\n      - user: user:anne\n        relation: user_in_context\n        object: organization:acme\n    check:\n      - user: user:anne\n        object: project:acme-website\n        assertions:\n            editor: true\n      - user: user:anne\n        object: project:contoso-website\n        assertions:\n            editor: false\n  - name: Anne can access the contoso-website when she's in context of the contoso organization\n    tuples:\n      # This contextual tuple represents Anne's current session\n      - user: user:anne\n        relation: user_in_context\n        object: organization:contoso\n    check:\n      - user: user:anne\n        object: project:acme-website\n        assertions:\n            editor: false\n      - user: user:anne\n        object: project:contoso-website\n        assertions:\n            editor: true\n"})}),"\n",(0,i.jsx)(n.h4,{id:"using-conditional-relationship-tuples",children:"Using Conditional Relationship Tuples"}),"\n",(0,i.jsx)(n.p,{children:"Instead of adding contextual tuples, you can attach conditions to your stored relationship tuples and provide the context values at request time. The condition compares stored values against request-time values."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"When to use this approach:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You want to avoid sending contextual tuples with every request"}),"\n",(0,i.jsx)(n.li,{children:"The condition logic involves comparing stored and request-time values"}),"\n",(0,i.jsx)(n.li,{children:"You prefer conditions over additional relations in your model"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dsl.openfga",children:'model: |\n  model\n    schema 1.1\n\n  type user\n\n  type organization\n    relations\n      define project_editor: [user with in_context]\n      define project_viewer: [user with in_context]\n\n  type project\n    relations\n      define organization: [organization]\n      define editor: project_editor from organization\n      define viewer: project_viewer from organization\n\n  condition in_context(project_org: string, user_org: string) {\n      project_org == user_org\n  }\n\ntuples:\n  - user: user:anne\n    relation: project_editor\n    object: organization:acme\n    condition:\n      name: in_context\n      context:\n        project_org: "acme"\n\n  - user: user:anne\n    relation: project_editor\n    object: organization:contoso\n    condition:\n      name: in_context\n      context:\n        project_org: "contoso"\n\n  - user: organization:acme\n    relation: organization\n    object: project:acme-website\n\n  - user: organization:contoso\n    relation: organization\n    object: project:contoso-website\n\ntests:\n  - name: Anne can access the acme-website when she\'s in context of the acme organization\n    check:\n      - user: user:anne\n        object: project:acme-website\n        context:\n          user_org: "acme"\n        assertions:\n            editor: true\n      - user: user:anne\n        object: project:contoso-website\n        context:\n          user_org: "acme"\n        assertions:\n            editor: false\n  - name: Anne can access the contoso-website when she\'s in context of the contoso organization\n    check:\n      - user: user:anne\n        object: project:acme-website\n        context:\n          user_org: "contoso"\n        assertions:\n            editor: false\n      - user: user:anne\n        object: project:contoso-website\n        context:\n          user_org: "contoso"\n        assertions:\n            editor: true\n'})}),"\n",(0,i.jsx)(n.h2,{id:"choosing-the-right-approach",children:"Choosing the Right Approach"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Approach"}),(0,i.jsx)(n.th,{children:"Best For"}),(0,i.jsx)(n.th,{children:"Pros"}),(0,i.jsx)(n.th,{children:"Cons"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"user:*"})," boolean flag"]}),(0,i.jsx)(n.td,{children:"Simple on/off attributes"}),(0,i.jsx)(n.td,{children:"Minimal tuples, easy to understand"}),(0,i.jsx)(n.td,{children:"Limited to boolean values"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Self-relations"}),(0,i.jsx)(n.td,{children:"Object-level properties"}),(0,i.jsx)(n.td,{children:"Clear semantics, explicit references"}),(0,i.jsx)(n.td,{children:"Requires self-referential tuple"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Contextual tuples"}),(0,i.jsx)(n.td,{children:"Dynamic session context"}),(0,i.jsx)(n.td,{children:"Context-free stored data, flexible"}),(0,i.jsx)(n.td,{children:"Must send tuples with every request"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Conditional relationship tuples"}),(0,i.jsx)(n.td,{children:"Comparing stored vs. request values"}),(0,i.jsx)(n.td,{children:"No extra tuples per request, powerful conditions"}),(0,i.jsx)(n.td,{children:"Condition logic can become complex"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"When deciding between these approaches, consider:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Data volatility"}),": Use stored attributes for stable data, request-time attributes for dynamic data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Model complexity"}),": Start with simpler patterns (like ",(0,i.jsx)(n.code,{children:"user:*"}),") and evolve to more complex ones as needed"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Attribute types"}),": Use conditions when you need typed values beyond booleans"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-sections",children:"Related Sections"}),"\n",(0,i.jsx)(r.XQ,{description:"Check out these related resources for more information about ABAC patterns in OpenFGA",relatedLinks:[{title:"Conditions",description:"Learn how to use conditions for time-based, IP-based, and other dynamic checks.",link:"./../modeling/conditions"},{title:"Contextual Tuples",description:"Understand how to send dynamic relationship data with each request.",link:"./../interacting/contextual-tuples"},{title:"Public Access",description:"Learn about the user:* pattern for granting access to everyone.",link:"./../modeling/public-access"},{title:"Modular Authorization Models",description:"Learn how to break down your authorization model into modules.",link:"./../modeling/modular-models"}]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);